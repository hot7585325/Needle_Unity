import{serializable as o,RectTransform as Je,Behaviour as h,Mathf as w,GameObject as m,OrbitControls as Nt,Text as Q,NeedleXRSession as ht,getTempVector as v,Camera as fe,serializeable as f,WebXR as ti,setWorldPosition as ct,Rigidbody as D,AudioSource as N,InstantiateOptions as ei,Renderer as y,InstancingUtil as ii,Button as zt,ActionBuilder as _,USDObject as lt,BehaviorModel as $,TriggerBuilder as A,Volume as ri,getWorldPosition as Tt,getParam as P,Gizmos as M,ParticleSystem as Ut,setParamWithoutReload as Vt,EventList as b,setWorldQuaternion as le,getWorldQuaternion as he,Animator as Wt,WebXRImageTracking as si,DeviceUtilities as x,LODGroup as ni,syncField as z,showBalloonMessage as u,AssetReference as ge,screenshot2 as ai,DragControls as oi,Animation as dt,USDZExporter as Gt,isDevEnvironment as K,delay as Et,SceneSwitcher as li,RoomEvents as hi,Collider as mt,LogType as be,WaitForSeconds as ci,isMobileDevice as pi,NeedleMenu as di,getTempQuaternion as mi,AnimationCurve as ui,NeedleXRController as ce,XRControllerFollow as fi,delayForFrames as Ht,MeshRenderer as gi,ParticleSystemShapeType as St,isDestroyed as xe,instantiate as bi,AnimationExtension as xi,PlayAnimationOnClick as pe,getOrAddComponent as vi,FileReference as ut,findObjectOfType as ve,ImageReference as wi,PlayableDirector as _i,TypeStore as c}from"./needle-engine@4.6.0.js";import{l as we,P as Oi,ax as C,v as pt,c as _e,h as Oe,aP as Mt,V as O,e as yi,M as Pi,T as Ci,r as ji,q as Si,b as Di,bf as Ti,bA as Ei,bJ as Mi,cS as $i,cT as Ai,am as de,Z as Ii,cJ as Li,cu as Fi,cz as Ni,cU as zi}from"./three@0.169.5.js";import{C as Ui,a as Vi,b as Wi}from"./three-examples.c78bc140.js";import"./gltf-progressive.28c3023d.js";import"./three-mesh-ui.78422980.js";import"./index-5d07a061.js";import"./three-quarks.78170687.js";var Gi=Object.defineProperty,Hi=Object.getOwnPropertyDescriptor,ye=(s,t,i,r)=>{for(var e=r>1?void 0:r?Hi(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Gi(t,i,e),e};class Rt extends h{constructor(){super(...arguments),this.safeArea=new we(0,0)}update(){var e,n,a;const t=this.context.domWidth/this.safeArea.x,i=this.context.domHeight/this.safeArea.y,r=w.clamp(Math.min(t,i),0,1);(e=this.rectTransform)==null||e.scale.setScalar(r),(a=(n=this.rectTransform)==null?void 0:n.shadowComponent)==null||a.scale.setScalar(r)}}ye([o(Je)],Rt.prototype,"rectTransform",2);ye([o(we)],Rt.prototype,"safeArea",2);var Ri=Object.defineProperty,qi=Object.getOwnPropertyDescriptor,qt=(s,t,i,r)=>{for(var e=r>1?void 0:r?qi(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Ri(t,i,e),e};class ft extends h{constructor(){super(...arguments),this.createMenuButton=!1,this.teleportVRPlayer=!1,this.ignoreYInVR=!1,this.menuButton=null}get orbitalCamera(){return this._orbitalCamera??(this._orbitalCamera=m.findObjectOfType(Nt)),this._orbitalCamera}awake(){this.createMenuButton&&this.addButton()}addButton(){var r;this.menuButton&&this.removeButton();const t=((r=this.gameObject.getComponentInChildren(Q))==null?void 0:r.text)??this.gameObject.name,i=document.createElement("button");this.menuButton=i,i.innerText=t.replace("_"," "),i.setAttribute("priority","40"),i.addEventListener("click",()=>this.use()),this.context.menu.appendChild(i)}removeButton(){this.menuButton&&(this.menuButton.remove(),this.menuButton=null)}use(){var i,r;(i=this.orbitalCamera)==null||i.setCameraTargetPosition(this.worldPosition);const t=(r=ht.active)==null?void 0:r.rig;if(this.teleportVRPlayer&&this.context.isInVR&&t){const e=v(this.worldPosition);this.ignoreYInVR&&(e.y=t.gameObject.worldPosition.y),t.gameObject.worldPosition=e}}}qt([o()],ft.prototype,"createMenuButton",2);qt([o()],ft.prototype,"teleportVRPlayer",2);qt([o()],ft.prototype,"ignoreYInVR",2);class Ki extends h{constructor(){super(...arguments),this.cam=null}onEnable(){this.cam=this.gameObject.getComponent(fe),this.cam||(console.warn("CameraLayer requires a Camera component"),this.enabled=!1)}onAfterRender(){if(!this.cam)return;const t=this.scene.background;this.context.renderer.autoClearColor=!1,this.cam.cam instanceof Oi&&this.context.updateAspect(this.cam.cam),this.scene.background=null,this.context.renderer.render(this.scene,this.cam.cam),this.scene.background=t}}var Qi=Object.defineProperty,Yi=Object.getOwnPropertyDescriptor,gt=(s,t,i,r)=>{for(var e=r>1?void 0:r?Yi(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Qi(t,i,e),e};class Y extends h{constructor(){super(...arguments),this.strength=10,this.maxInstances=10,this._instances=[],this._index=-1,this._onPointerDown=t=>{t.button===0&&this.throwBall(t.space.worldPosition,t.space.worldForward)}}start(){this.prefab&&m.setActive(this.prefab,!1),this.webXR??(this.webXR=m.findObjectOfType(ti))}onEnable(){this.context.input.addEventListener("pointerdown",this._onPointerDown)}onDisable(){this.context.input.removeEventListener("pointerdown",this._onPointerDown)}throwBall(t,i){var a,l;if(!this.prefab)return;if(this._instances.length<this.maxInstances){const p=new ei;p.position=t;const d=m.instantiate(this.prefab,p);if(!d)return;this._instances.push(d)}const r=++this._index,e=this._instances[r%this._instances.length];if(!e)return;ct(e,t),m.setActive(e,!0),(a=this.audioSource)==null||a.stop(),(l=this.audioSource)==null||l.play();const n=m.getComponent(e,D);n&&(i.multiplyScalar(this.strength),n.resetForcesAndTorques(),n.resetVelocities(),n==null||n.applyImpulse(i))}}gt([f(C)],Y.prototype,"prefab",2);gt([f(N)],Y.prototype,"audioSource",2);gt([f()],Y.prototype,"strength",2);gt([f()],Y.prototype,"maxInstances",2);var Zi=Object.defineProperty,ki=Object.getOwnPropertyDescriptor,Pe=(s,t,i,r)=>{for(var e=r>1?void 0:r?ki(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Zi(t,i,e),e};class Kt extends h{constructor(){super(...arguments),this.applyOnStart=!0,this.randomMetallicRoughness=!0}start(){{const t=this.gameObject.getComponent(y);if(!t)return;for(let i=0;i<t.sharedMaterials.length;i++)t.sharedMaterials[i]=t.sharedMaterials[i].clone()}this.applyOnStart&&this.applyRandomColor()}applyRandomColor(){const t=this.gameObject.getComponent(y);if(!t){console.warn("Can not change color: No renderer on "+this.name);return}for(let i=0;i<t.sharedMaterials.length;i++){const r=t.sharedMaterials[i];r.color=new pt(Math.random(),Math.random(),Math.random()),this.randomMetallicRoughness&&r instanceof _e&&(r.metalness=Math.random(),r.roughness=Math.random()*Math.random()),r.needsUpdate=!0,ii.markDirty(this.gameObject)}}}Pe([f()],Kt.prototype,"applyOnStart",2);Pe([f()],Kt.prototype,"randomMetallicRoughness",2);class Bi extends h{constructor(){super(...arguments),this.renderer=null,this.collisionCount=0}start(){if(this.renderer=this.gameObject.getComponent(y),!!this.renderer){this._startColor||(this._startColor=[]);for(let t=0;t<this.renderer.sharedMaterials.length;t++)this.renderer.sharedMaterials[t]=this.renderer.sharedMaterials[t].clone(),this._startColor[t]=this.renderer.sharedMaterials[t].color.clone()}}onCollisionEnter(t){if(this.renderer){this.collisionCount+=1;for(let i=0;i<this.renderer.sharedMaterials.length;i++)this.renderer.sharedMaterials[i].color.setRGB(Math.random(),Math.random(),Math.random())}}onCollisionExit(t){if(!(!this.renderer||!this._startColor)&&(this.collisionCount-=1,this.collisionCount===0))for(let i=0;i<this.renderer.sharedMaterials.length;i++)this.renderer.sharedMaterials[i].color.copy(this._startColor[i])}}var Xi=Object.defineProperty,Ji=Object.getOwnPropertyDescriptor,tr=(s,t,i,r)=>{for(var e=r>1?void 0:r?Ji(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Xi(t,i,e),e};class Ce extends h{update(){this.myMaterial&&(this.myMaterial._Speed*=1+this.context.time.deltaTime,this.myMaterial._Speed>1&&(this.myMaterial._Speed=5e-4),this.context.time.frame%30===0&&console.log(this.myMaterial._Speed))}}tr([o(Oe)],Ce.prototype,"myMaterial",2);var er=Object.defineProperty,ir=Object.getOwnPropertyDescriptor,rr=(s,t,i,r)=>{for(var e=r>1?void 0:r?ir(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&er(t,i,e),e};class je extends h{click(){var t,i;(i=(t=this.buttonToClick)==null?void 0:t.onClick)==null||i.invoke()}}rr([o(zt)],je.prototype,"buttonToClick",2);var sr=Object.defineProperty,nr=Object.getOwnPropertyDescriptor,ar=(s,t,i,r)=>{for(var e=r>1?void 0:r?nr(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&sr(t,i,e),e};class Se extends h{constructor(){super(...arguments),this.objectToMatrix=new Map}start(){var t;(t=this.target)==null||t.traverse(i=>{this.objectToMatrix.set(i,i.matrix.clone())})}onPointerClick(t){for(const[i,r]of this.objectToMatrix)i.matrix.copy(r),i.matrix.decompose(i.position,i.quaternion,i.scale),i.matrixWorldNeedsUpdate=!0}createBehaviours(t,i,r){if(i.uuid!==this.gameObject.uuid||!this.target)return;const e=_.parallel();for(const[p,d]of this.objectToMatrix){const g=lt.createEmpty();g.matrix=d,p.parent&&g.matrix.premultiply(p.parent.matrixWorld),r.document.add(g),e.addAction(_.transformAction(p,g,0,"absolute","none"))}const n=new $("click_to_reset",A.tapTrigger(this.gameObject),e);t.addBehavior(n);const a=lt.createEmpty();a.name="InputTarget",a.displayName=void 0,a.type="RealityKitComponent",a.onSerialize=p=>{p.appendLine("bool allowsDirectInput = 1"),p.appendLine("bool allowsIndirectInput = 1"),p.appendLine('uniform token info:id = "RealityKit.InputTarget"')},i.add(a);const l=lt.createEmpty();l.name="HoverEffect",l.displayName=void 0,l.type="RealityKitComponent",l.onSerialize=p=>{p.appendLine('uniform token info:id = "RealityKit.HoverEffect"')},i.add(l)}}ar([o(m)],Se.prototype,"target",2);var or=Object.defineProperty,lr=Object.getOwnPropertyDescriptor,Qt=(s,t,i,r)=>{for(var e=r>1?void 0:r?lr(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&or(t,i,e),e};class bt extends h{constructor(){super(...arguments),this.apertureMultiplier=2,this.focalLength=.001,this.focusDistanceCutoff=25,this.volume=null,this.dofEffect=void 0}onEnable(){var t,i,r;this.volume=m.findObjectOfType(ri),this.dofEffect=(r=(i=(t=this.volume)==null?void 0:t.sharedProfile)==null?void 0:i.components)==null?void 0:r.find(e=>e.typeName==="DepthOfField"),this.orbit=m.findObjectOfType(Nt)}onBeforeRender(){var i;if(!((i=this.orbit)!=null&&i.controls))return;const t=this.orbit.controls.target.distanceTo(Tt(this.orbit.gameObject));if(this.dofEffect){this.dofEffect.focusDistance.value=t,this.dofEffect.focalLength.value=this.focalLength;let r=w.inverseLerp(0,this.focusDistanceCutoff,t);r=w.clamp01(r),this.dofEffect.aperture.value=w.lerp(this.apertureMultiplier,32,r);const e=this.focusDistanceCutoff;t>e&&this.dofEffect.active?this.dofEffect.active=!1:t<e&&!this.dofEffect.active&&(this.dofEffect.active=!0)}}}Qt([o()],bt.prototype,"apertureMultiplier",2);Qt([o()],bt.prototype,"focalLength",2);Qt([o()],bt.prototype,"focusDistanceCutoff",2);class hr extends h{constructor(){super(...arguments),this._previousEnvironmentTexture=null}onEnable(){this._previousEnvironmentTexture=this.context.scene.environment,this.context.scene.environment=null}onDisable(){this.context.scene.environment=this._previousEnvironmentTexture}}var cr=Object.defineProperty,pr=Object.getOwnPropertyDescriptor,dr=(s,t,i,r)=>{for(var e=r>1?void 0:r?pr(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&cr(t,i,e),e};const mr=P("sample_debugParticlesOnClick");class De extends h{constructor(){super(...arguments),this.particleSystems=[]}update(){if(!this.context.isInVR&&this.context.input.getPointerClicked(0)){const t=this.context.physics.raycast();t.length>0&&this.spawnParticlesAt(t[0].point)}}onUpdateXR(t){t.xr.controllers.forEach(i=>{var r,e;if(((r=i.getButton("primary"))==null?void 0:r.isDown)===!0){const n=(e=this.context.physics.raycastFromRay(i.ray))==null?void 0:e.at(0);n&&this.spawnParticlesAt(n.point)}})}spawnParticlesAt(t){ct(this.gameObject,t),mr&&M.DrawWireSphere(t,.5,16711680,1);for(const i of this.particleSystems)i&&(m.setActive(i.gameObject,!0),i.play())}}dr([f(Ut)],De.prototype,"particleSystems",2);var ur=Object.defineProperty,fr=Object.getOwnPropertyDescriptor,gr=(s,t,i,r)=>{for(var e=r>1?void 0:r?fr(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&ur(t,i,e),e};class Te extends h{constructor(){super(...arguments),this.parameters=[]}awake(){var t=!1;this.parameters.forEach(i=>{P(i)||(Vt(i,""),t=!0)}),t&&window.location.reload()}}gr([o()],Te.prototype,"parameters",2);var br=Object.defineProperty,xr=Object.getOwnPropertyDescriptor,Ee=(s,t,i,r)=>{for(var e=r>1?void 0:r?xr(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&br(t,i,e),e};class Yt extends h{constructor(){super(...arguments),this.htmlSelector="button.some-button",this.onClick=new b,this.onClicked=()=>{this.onClick.invoke()}}onEnable(){this.element=document.querySelector(this.htmlSelector),this.element?this.element.addEventListener("click",this.onClicked):console.warn(`Could not find element with selector "${this.htmlSelector}"`)}onDisable(){this.element&&this.element.removeEventListener("click",this.onClicked)}}Ee([f()],Yt.prototype,"htmlSelector",2);Ee([o(b)],Yt.prototype,"onClick",2);var vr=Object.defineProperty,wr=Object.getOwnPropertyDescriptor,Me=(s,t,i,r)=>{for(var e=r>1?void 0:r?wr(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&vr(t,i,e),e};class Zt extends h{constructor(){super(...arguments),this.createdElements=[]}onEnable(){var t;if(!(!this.methods||!this.names))for(let i=0;i<this.methods.length;i++){const r=this.methods[i];let e="Button";i<((t=this.names)==null?void 0:t.length)&&(e=this.names[i]);const n=document.createElement("button");n.innerHTML=e,n.onclick=()=>{r.invoke()},this.context.menu.appendChild(n),this.createdElements.push(n)}}onDisable(){for(const t of this.createdElements)t.remove()}reloadPageInSeconds(t){setTimeout(()=>{location.reload()},t*1e3)}}Me([o(b)],Zt.prototype,"methods",2);Me([o()],Zt.prototype,"names",2);var _r=Object.defineProperty,Or=Object.getOwnPropertyDescriptor,xt=(s,t,i,r)=>{for(var e=r>1?void 0:r?Or(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&_r(t,i,e),e};class Z extends h{constructor(){super(...arguments),this.url="https://www.youtube.com/embed/puWNRrG4MCg",this.pixelsPerUnit=500,this.borderRadius=50,this.animator=null,this.rotate90=new Mt().setFromAxisAngle(new O(0,1,0),Math.PI)}start(){const t=P("url");t&&(this.url=t);const i=document.createElement("div");i.innerHTML='<iframe width="1000" height="1000" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; xr-spatial-tracking; xr" allowfullscreen></iframe>',i.style.zIndex="10000",i.style.position="absolute",i.style.pointerEvents="initial";const r=i.querySelector("iframe");r.addEventListener("load",()=>{setTimeout(()=>{var p;console.log("Automatically opening iframe"),(p=this.animator)==null||p.SetBool("Open",!0)},1e3)}),r.src=this.url;let e=1e3;const n=Math.round(this.gameObject.scale.x*this.pixelsPerUnit),a=Math.round(this.gameObject.scale.y*this.pixelsPerUnit);e=Math.max(n,a),r.width=n+"px",r.height=a+"px",i.style.position="absolute",this.borderRadius>0&&(i.style.borderRadius=this.borderRadius+"px"),i.style.pointerEvents="initial",document.body.append(i),this.cssRenderer=new Ui,this.cssRenderer.domElement.style.pointerEvents="none",this.cssRenderer.domElement.style.position="absolute",this.cssRenderer.domElement.style.top="0px",document.body.append(this.cssRenderer.domElement),this.cssScene=new yi;const l=new Vi(i);l.scale.setScalar(Math.max(this.gameObject.scale.x,this.gameObject.scale.y)/e),ct(l,Tt(this.gameObject)),le(l,he(this.gameObject)),l.quaternion.multiply(this.rotate90),this.cssScene.add(l),this.cssObj=l,this.context.post_render_callbacks.push(this.onPostRender.bind(this))}onPostRender(){if(!this.cssObj||!this.cssRenderer||!this.cssScene)return;ct(this.cssObj,Tt(this.gameObject)),le(this.cssObj,he(this.gameObject)),this.cssObj.quaternion.multiply(this.rotate90);const t=this.context.mainCamera,i=this.gameObject;var r=t.position.clone().sub(this.gameObject.position).normalize(),e=i.getWorldDirection(new O);const n=r.dot(e);this.cssObj.visible=n<.15;const a=this.cssRenderer.getSize();(a.width!==this.context.domWidth||a.height!==this.context.domHeight)&&this.cssRenderer.setSize(this.context.domWidth,this.context.domHeight),this.cssRenderer.render(this.cssScene,this.context.mainCamera)}}xt([f()],Z.prototype,"url",2);xt([f()],Z.prototype,"pixelsPerUnit",2);xt([f()],Z.prototype,"borderRadius",2);xt([f(Wt)],Z.prototype,"animator",2);class yr extends h{constructor(){super(...arguments),this._ui=null,this._incubationsHint=null,this._components=[]}onEnable(){var e;(e=this._ui)==null||e.remove(),this._components=m.findObjectsOfType(si);const t=document.createElement("div");t.style.cssText=`
            font-family: 'Roboto flex', Ariel;
            position: absolute;
            top: 1em;
            left: 1em;
            line-height: 1.5em;
            display: block;
            width: 200px;
        `,this.context.domElement.appendChild(t),this._ui=t;const i=document.createElement("h2");i.style.cssText=`
            margin-bottom: .7em;
        `,i.innerText="Sample Images",t.appendChild(i);const r=document.createElement("p");r.innerHTML=`Download the image and print it or you can also open the image in your browser
        <br><strong>Then enter AR and scan it with your camera.</strong>
        <br>Visit our <a target="_blank" href="https://docs.needle.tools/image-tracking">ImageTracking documentation</a> for more information.
        `,r.style.userSelect="all",t.appendChild(r);for(const n of this._components)this.createDownloadImageUI(n,t)}onDisable(){var t;(t=this._ui)==null||t.remove()}update(){var t;this.context.isInAR?(t=this._ui)==null||t.remove():this._ui&&!this._ui.parentNode&&this.context.domElement.appendChild(this._ui)}onUpdateXR(t){if(t.xr.frame&&!("getImageTrackingResults"in t.xr.frame)&&!this._incubationsHint&&this._ui&&x.isAndroidDevice()){const i=document.createElement("p");i.style.cssText=`
                    background: rgba(255, 100, 100, .7);
                    border-radius: .5rem;
                    padding: .4rem;
                `,i.innerText="WebXR ImageTracking is not enabled. Go to chrome://flags/#webxr-incubations and enable #webxr-incubations",this._ui.append(i),this._incubationsHint=i}}createDownloadImageUI(t,i){if(t.trackedImages)for(const r of t.trackedImages){if(!r.image)continue;const e=document.createElement("a");e.href=r.image,e.target="_blank",i.appendChild(e);const n=document.createElement("img");n.src=r.image,n.style.cssText=`
                min-width: 180px;
                max-width: 220px;
                width: 15vw;
                height: auto;
                aspect-ratio: 1.3;
                object-fit: cover;
                background: rgba(0,0,0,0.5);
                border-radius: 10px;
                border: 2px solid rgba(255,255,255,1);
                box-shadow: 0 0 10px rgba(0,0,0,.2);
                margin-left: -.5em;
            `,e.appendChild(n)}}}var Pr=Object.defineProperty,Cr=Object.getOwnPropertyDescriptor,$e=(s,t,i,r)=>{for(var e=r>1?void 0:r?Cr(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Pr(t,i,e),e};class kt extends h{constructor(){super(...arguments),this.tempVec1=new O,this.tempVec2=new O}update(){if(!this.lodGroup||!this.text)return;const t=this.context.mainCamera;t.getWorldPosition(this.tempVec1),this.gameObject.getWorldPosition(this.tempVec2);const i=this.tempVec1.distanceTo(this.tempVec2)/t.zoom,r=this.lodGroup._lodsHandler;let e=null;r==null||r.forEach(n=>{var d,g;const a=n.levels[n.getCurrentLevel()],l=n.levels.at(n.getCurrentLevel()+1);let p=null;if(a.object instanceof Pi){const S=a.object.geometry.attributes,F=Math.floor(((d=S.position)==null?void 0:d.count)||0);p=`Triangles: ${Math.floor((((g=S.index)==null?void 0:g.count)||F)/3)}, Vertices: ${F}`}a.object.name.replace(/_/g,""),a.object.name.includes("Cull")||(e="",p&&(e+=`${p}
`),l==null||l.hysteresis,e+=`${a.distance.toFixed(1)} / ${i.toFixed(1)}`,l&&(e+=` / ${(l.distance-l.distance*l.hysteresis).toFixed(1)}`))}),e||(e="culled"),this.text.text=e}}$e([o(ni)],kt.prototype,"lodGroup",2);$e([o(Q)],kt.prototype,"text",2);var jr=Object.defineProperty,Sr=Object.getOwnPropertyDescriptor,Bt=(s,t,i,r)=>{for(var e=r>1?void 0:r?Sr(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&jr(t,i,e),e};class $t extends h{onColorChanged(){typeof this.color=="number"&&(this.color=new pt(this.color)),this.setColorToMaterials()}onPointerClick(t){const i=new pt(Math.random(),Math.random(),Math.random());this.color=i}onEnable(){u("<strong>Click an object</strong> to change the color. Open this window in another browser tab/window to see the networking in action..."),this.setColorToMaterials()}setColorToMaterials(){var i;const t=this.gameObject.getComponent(y);if(t)for(let r=0;r<t.sharedMaterials.length;r++){const e=(i=t.sharedMaterials[r])==null?void 0:i.clone();t.sharedMaterials[r]=e,e&&"color"in e&&(e.color=this.color)}else console.warn("No renderer found",this.gameObject)}}Bt([z($t.prototype.onColorChanged),o(pt)],$t.prototype,"color",2);class At extends h{constructor(){super(...arguments),this.myArray=[],this.updateArray=()=>{const t=new Date().toLocaleTimeString();console.log("> Update array",t),this.myArray.length>10&&(console.log("Clearing array because we have reached 10 entries"),this.myArray.length=0),this.myArray.push(t),this.myArray=this.myArray,u(`<strong>> Send</strong> "${t}", ${this.myArray.length} elements`)}}onArrayChanged(){console.log("< Received array",this.myArray[this.myArray.length-1],this.myArray),u(`<strong>< Received</strong> "${this.myArray[this.myArray.length-1]}", we now have ${this.myArray.length} elements`)}start(){u("Open this window in another browser tab/window to see the networking in action..."),setInterval(this.updateArray,4e3)}}Bt([z(At.prototype.onArrayChanged)],At.prototype,"myArray",2);class Dr{constructor(){this.name="",this.age=0}}class It extends h{constructor(){super(...arguments),this.myObject=new Dr,this.updateObject=()=>{this.myObject.name=this.context.connection.connectionId,this.myObject.age+=1,this.myObject=this.myObject,console.log("> Updated",this.myObject),u('<strong>> Sent</strong> "'+this.myObject.name+'" is '+this.myObject.age+" years old")}}onObjectChanged(){console.log("< Received object",this.myObject),u(`<strong>< Received</strong> "${this.myObject.name}" is ${this.myObject.age} years old`)}awake(){u("Open this window in another browser tab/window to see the networking in action..."),setInterval(this.updateObject,5e3)}}Bt([z(It.prototype.onObjectChanged)],It.prototype,"myObject",2);var Tr=Object.defineProperty,Er=Object.getOwnPropertyDescriptor,Ae=(s,t,i,r)=>{for(var e=r>1?void 0:r?Er(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Tr(t,i,e),e};class Xt extends h{constructor(){super(...arguments),this.clampFrameRate=!0,this._clampFrameRate=!1,this.maxFrameRate=72,this._maxFrameRate=-1024}update(){if(this._clampFrameRate!==this.clampFrameRate||this._maxFrameRate!==this.maxFrameRate){const t=this.clampFrameRate?this.maxFrameRate:void 0;this.context.targetFrameRate=t,this._clampFrameRate=this.clampFrameRate,this._maxFrameRate=this.maxFrameRate}}setTarget(t){this.maxFrameRate=t,this.clampFrameRate=!0}setClamping(t){this.clampFrameRate=t}}Ae([o()],Xt.prototype,"clampFrameRate",2);Ae([o()],Xt.prototype,"maxFrameRate",2);var Mr=Object.defineProperty,$r=Object.getOwnPropertyDescriptor,vt=(s,t,i,r)=>{for(var e=r>1?void 0:r?$r(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Mr(t,i,e),e};class k extends h{constructor(){super(...arguments),this.width=1024,this.height=1024,this.prefab=null}takePhoto(){const t=ai({type:"texture",camera:this.camera,width:this.width,height:this.height});this.prefab&&t instanceof Ci&&this.prefab.instantiate(this.scene).then(i=>{if(!i)return;setTimeout(()=>{i.destroy()},2e3),i==null||i.position.set(0,3,0),i==null||i.getOrAddComponent(oi);const r=i==null?void 0:i.getComponentInChildren(D);r&&(r.teleport(this.gameObject.worldPosition.add({x:0,y:.5,z:0})),r.setAngularVelocity(Math.random()-.5,Math.random()-.5,Math.random()*2-1),r.applyImpulse(this.gameObject.worldForward.add({x:0,y:2,z:0}).normalize().multiplyScalar(.01)));const e=i==null?void 0:i.getComponentInChildren(y);if(e){const n=e.sharedMaterial.clone()||new _e;n&&"map"in n&&(n.map=t,n.side=ji),e.sharedMaterial=n}})}}vt([o(fe)],k.prototype,"camera",2);vt([o()],k.prototype,"width",2);vt([o()],k.prototype,"height",2);vt([o(ge)],k.prototype,"prefab",2);var Ar=Object.defineProperty,Ir=Object.getOwnPropertyDescriptor,I=(s,t,i,r)=>{for(var e=r>1?void 0:r?Ir(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Ar(t,i,e),e};class B extends h{constructor(){super(...arguments),this.logEvents=!1}onCollisionEnter(t){var i;this.logEvents&&console.log("ENTER",t),(i=this.onEnter)==null||i.invoke(t)}onCollisionStay(t){var i;this.logEvents&&console.log("STAY",t),(i=this.onStay)==null||i.invoke(t)}onCollisionExit(t){var i;this.logEvents&&console.log("EXIT",t),(i=this.onExit)==null||i.invoke(t)}}I([f(b)],B.prototype,"onEnter",2);I([f(b)],B.prototype,"onStay",2);I([f(b)],B.prototype,"onExit",2);I([f()],B.prototype,"logEvents",2);class X extends h{onTriggerEnter(t){var i,r;this.triggerObjects&&this.triggerObjects.length>0&&!((i=this.triggerObjects)!=null&&i.includes(t.gameObject))||(r=this.onEnter)==null||r.invoke()}onTriggerStay(t){var i,r;this.triggerObjects&&this.triggerObjects.length>0&&!((i=this.triggerObjects)!=null&&i.includes(t.gameObject))||(r=this.onStay)==null||r.invoke()}onTriggerExit(t){var i,r;this.triggerObjects&&this.triggerObjects.length>0&&!((i=this.triggerObjects)!=null&&i.includes(t.gameObject))||(r=this.onExit)==null||r.invoke()}}I([f(m)],X.prototype,"triggerObjects",2);I([f(b)],X.prototype,"onEnter",2);I([f(b)],X.prototype,"onStay",2);I([f(b)],X.prototype,"onExit",2);var Lr=Object.defineProperty,Fr=Object.getOwnPropertyDescriptor,Nr=(s,t,i,r)=>{for(var e=r>1?void 0:r?Fr(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Lr(t,i,e),e};class Ie extends h{constructor(){super(...arguments),this._lastTriggerTime=0}onTriggerEnter(t){this.context.time.time-this._lastTriggerTime<.3||(this._lastTriggerTime=this.context.time.time,this.animation&&this.animation.play(0,{loop:!1}))}onTriggerExit(){}}Nr([f(dt)],Ie.prototype,"animation",2);var zr=Object.defineProperty,Ur=Object.getOwnPropertyDescriptor,Vr=(s,t,i,r)=>{for(var e=r>1?void 0:r?Ur(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&zr(t,i,e),e};class Le extends h{onTriggerEnter(){var t,i;(t=this.animation)!=null&&t.isPlaying||(i=this.animation)==null||i.play(0,{loop:!1})}}Vr([f(dt)],Le.prototype,"animation",2);var Wr=Object.defineProperty,Gr=Object.getOwnPropertyDescriptor,Hr=(s,t,i,r)=>{for(var e=r>1?void 0:r?Gr(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Wr(t,i,e),e};class Fe extends h{onCollisionEnter(){var t,i;(t=this.audioSource)==null||t.stop(),(i=this.audioSource)==null||i.play()}}Hr([f(N)],Fe.prototype,"audioSource",2);class Rr extends h{onEnable(){const t=m.findObjectOfType(Gt);t==null||t.addEventListener("before-export",()=>{this.resetAnimations()})}onEnterXR(t){this.resetAnimations()}resetAnimations(){console.warn("Resetting animations and audio for XR export.");const t=m.findObjectsOfType(dt);for(const r of t)r.actions.forEach(e=>{e.reset(),e.time=0,e.play()});const i=m.findObjectsOfType(N);for(const r of i)r.stop(),r.play()}}var qr=Object.defineProperty,Kr=Object.getOwnPropertyDescriptor,Ne=(s,t,i,r)=>{for(var e=r>1?void 0:r?Kr(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&qr(t,i,e),e};class Jt extends h{constructor(){super(...arguments),this.referenceSize=512,this.updateSize=()=>{if(this.content){if(this.referenceSize<=0)return console.error("ResponsiveContent: Base width must be greater than 0.");const t=this.context.domWidth/this.referenceSize;this.content.scale.set(t,t,t)}else K()&&console.warn("ResponsiveContent: No content object set.")}}onEnable(){window.addEventListener("resize",this.updateSize),this.updateSize()}onDisable(){window.removeEventListener("resize",this.updateSize)}}Ne([o(C)],Jt.prototype,"content",2);Ne([o()],Jt.prototype,"referenceSize",2);var Qr=Object.defineProperty,Yr=Object.getOwnPropertyDescriptor,te=(s,t,i,r)=>{for(var e=r>1?void 0:r?Yr(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Qr(t,i,e),e};class ze extends h{async sceneOpened(){var t;(t=this.animator)==null||t.setBool("SceneOpen",!0),this._htmlElement=this._getHtmlElement(),this.context.domElement.appendChild(this._htmlElement)}async sceneClosing(){var t,i;await Et(1e3),(t=this.animator)==null||t.setBool("SceneOpen",!1),await Et(1e3),(i=this._htmlElement)==null||i.remove()}_getHtmlElement(){if(!this._htmlElement){this._htmlElement=document.createElement("div"),this._htmlElement.style.cssText=`
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                display: flex;
                justify-content: center;
                align-items: center;
                // backdrop-filter: blur(10px);
            `;const t=document.createElement("img");t.src="https://engine.needle.tools/branding/needle-logo.png",this._htmlElement.appendChild(t)}return this._htmlElement}}te([o(Wt)],ze.prototype,"animator",2);class ee extends h{sceneOpened(){var t;return K()&&console.log("Scene opened",this.name),(t=this.opened)==null||t.invoke(),Promise.resolve()}sceneClosing(){var t;return K()&&console.log("Scene closing",this.name),(t=this.closing)==null||t.invoke(),Promise.resolve()}}te([o(b)],ee.prototype,"opened",2);te([o(b)],ee.prototype,"closing",2);class Zr extends h{next(){var t;this.switcher??(this.switcher=this.get()),console.log(this.switcher),(t=this.switcher)==null||t.selectNext()}previous(){var t;this.switcher??(this.switcher=this.get()),(t=this.switcher)==null||t.selectPrev()}get(){return m.findObjectOfType(li)}}class kr extends h{awake(){const t=this.gameObject.getComponent(y);if(t!=null&&t.sharedMaterials)for(const i of t.sharedMaterials)i&&(i.side=Si)}}var Br=Object.defineProperty,Xr=Object.getOwnPropertyDescriptor,Jr=(s,t,i,r)=>{for(var e=r>1?void 0:r?Xr(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Br(t,i,e),e};class Ue extends h{constructor(){super(...arguments),this.text=""}start(){u(this.text)}}Jr([o()],Ue.prototype,"text",2);var ts=Object.defineProperty,es=Object.getOwnPropertyDescriptor,is=(s,t,i,r)=>{for(var e=r>1?void 0:r?es(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&ts(t,i,e),e};const rs=P("testleaderboard");class Lt extends h{constructor(){super(...arguments),this._ready=!1}get ready(){return this._ready}onEnable(){this.context.connection.beginListen(hi.JoinedRoom,async()=>{await Et(100),this.context.connection.tryGetState(this.guid)||(this.data={scores:[]}),this._ready=!0}),rs?(console.log("Enabled test leaderboard, adding random scores"),setInterval(()=>{this.insertScore("Player",Math.floor(Math.random()*1e3))},2e3)):K()&&u("You can add ?testleaderboard to the url to test the leaderboard")}insertScore(t,i){if(!this._ready){console.warn("Cannot insert score, data not received yet");return}const r=10,e=this.data.scores;for(;e.length>=r;){this.sortScores();const n=e.pop();if(n.score>i){console.log(`Score ${i} is lower than ${n==null?void 0:n.score} (lowest score), ignoring`),e.push(n);return}}console.log("Inserting score",t,i),e.push({name:t,score:i}),this.sortScores(),this.data=this.data}sortScores(){this.data.scores.sort((t,i)=>i.score-t.score)}onDataChanged(t){if(console.warn("Data changed!",t,this.data.scores),this.data.scores.length>0){const i=this.data.scores[0];u("HIGHSCORE - "+i.name+": "+i.score)}this.dispatchEvent(new CustomEvent("changed",{detail:this.data}))}}is([z(Lt.prototype.onDataChanged)],Lt.prototype,"data",2);var ss=Object.defineProperty,ns=Object.getOwnPropertyDescriptor,as=(s,t,i,r)=>{for(var e=r>1?void 0:r?ns(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&ss(t,i,e),e};class Ve extends h{start(){this.updateStartPosition();const t=m.findObjectOfType(Gt);t&&t.addEventListener("before-export",()=>{this.resetToStart()})}updateStartPosition(){this.gameObject.updateMatrix(),this.startPosition=this.gameObject.position.clone(),this.startMatrix=this.gameObject.matrix.clone()}resetToStart(){if(!this.startPosition)return;const t=m.getComponent(this.gameObject,D);t==null||t.teleport(this.startPosition)}}class We extends Ve{start(){super.start(),this.worldCollider||console.warn("Missing collider to reset",this)}onTriggerExit(t){t===this.worldCollider&&this.resetToStart()}createBehaviours(t,i,r){if(i.uuid!==this.gameObject.uuid||!this.startPosition||!this.startMatrix)return;const e=lt.createEmpty();this.gameObject.parent?e.matrix=this.gameObject.parent.matrixWorld.clone().multiply(this.startMatrix):e.matrix=this.startMatrix,r.document.add(e);const n=new $("_reset_"+this.name+"_afterTime",A.sceneStartTrigger(),_.sequence(_.waitAction(Math.random()*4+1),_.sequence(_.transformAction(this.gameObject,e,0,"absolute","none"),_.waitAction(5)).makeLooping())).makeExclusive(!0);t.addBehavior(n)}}as([f(mt)],We.prototype,"worldCollider",2);var os=Object.defineProperty,ls=Object.getOwnPropertyDescriptor,hs=(s,t,i,r)=>{for(var e=r>1?void 0:r?ls(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&os(t,i,e),e};class Ge extends h{constructor(){super(...arguments),this.roomId="",this.playerCount=0}update(){const t=this.context.connection;let i=!1;t.currentRoomName&&t.currentRoomName!==this.roomId&&(this.roomId=t.currentRoomName,i=!0),t.usersInRoom().length!==this.playerCount&&(this.playerCount=t.usersInRoom().length,i=!0),i&&this.connectionLabel&&(this.connectionLabel.text=`Room: ${this.roomId}
Users: ${this.playerCount}
Your id: ${t.connectionId}`)}}hs([o(Q)],Ge.prototype,"connectionLabel",2);var cs=Object.defineProperty,ps=Object.getOwnPropertyDescriptor,ds=(s,t,i,r)=>{for(var e=r>1?void 0:r?ps(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&cs(t,i,e),e};class He extends h{constructor(){super(...arguments),this.interval=1e3,this.max=100,this.spawned=0}awake(){if(!this.object){console.warn("TimedSpawn: no object to spawn"),u("TimedSpawn: no object to spawn",be.Warn);return}m.setActive(this.object,!1),this.startCoroutine(this.spawn())}*spawn(){if(this.object)for(;this.spawned<this.max;){const t=m.instantiate(this.object);m.setActive(t,!0),this.spawned+=1,yield ci(this.interval/1e3)}}}ds([f(m)],He.prototype,"object",2);var ms=Object.defineProperty,us=Object.getOwnPropertyDescriptor,fs=(s,t,i,r)=>{for(var e=r>1?void 0:r?us(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&ms(t,i,e),e};class Re extends h{constructor(){super(...arguments),this.onlyMobile=!1}awake(){if(this.onlyMobile&&!pi())return;const t=this.gameObject.getComponent(di);t&&(t.position="top")}}fs([o()],Re.prototype,"onlyMobile",2);class gs extends h{constructor(){super(...arguments),this._video=null}async onEnable(){this._video??(this._video=document.createElement("video")),this._video.style.cssText=`
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            object-fit: cover;
        `,this.context.domElement.shadowRoot.appendChild(this._video);const t=await navigator.mediaDevices.getUserMedia({video:!0});!t||!this.enabled||(this._video.srcObject=t,this._video.play())}onDisable(){var t,i;(t=this._video)==null||t.pause(),(i=this._video)==null||i.remove()}}var bs=Object.defineProperty,xs=Object.getOwnPropertyDescriptor,wt=(s,t,i,r)=>{for(var e=r>1?void 0:r?xs(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&bs(t,i,e),e};class J extends h{constructor(){super(...arguments),this.interval=3,this.resetPosition=!0,this.resetRotation=!1,this.resetVelocity=!1}start(){const t=this.gameObject.position.clone(),i=this.gameObject.rotation.clone(),r=this.gameObject.getComponent(D),e=this.context.time.frame;setInterval(()=>{this.resetPosition&&this.gameObject.position.copy(t),this.resetRotation&&this.gameObject.rotation.copy(i),r&&this.resetVelocity&&this.context.time.frame!==e&&r.resetVelocities()},this.interval*1e3)}}wt([o()],J.prototype,"interval",2);wt([o()],J.prototype,"resetPosition",2);wt([o()],J.prototype,"resetRotation",2);wt([o()],J.prototype,"resetVelocity",2);class vs extends h{constructor(){super(...arguments),this.toggleRendererOnly=!1}start(){setInterval(()=>{if(u('This is a sample for showing how to <a href="https://engine.needle.tools/docs/scripting.html#component-architecture" target="_blank">toggle visibility of a GameObject</a>'),this.toggleRendererOnly){const t=this.gameObject.getComponent(y);t&&(t.enabled=!t.enabled)}else this.gameObject.visible=!this.gameObject.visible},1e3)}}var ws=Object.defineProperty,_s=Object.getOwnPropertyDescriptor,Os=(s,t,i,r)=>{for(var e=r>1?void 0:r?_s(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&ws(t,i,e),e};class qe extends h{awake(){this.material&&(this.material.wireframe=!0)}}Os([o(Oe)],qe.prototype,"material",2);var ys=Object.defineProperty,Ps=Object.getOwnPropertyDescriptor,Ke=(s,t,i,r)=>{for(var e=r>1?void 0:r?Ps(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&ys(t,i,e),e};class ie extends h{constructor(){super(...arguments),this.onSessionStart=new b,this.onSessionEnd=new b}onEnterXR(t){this.onWebXRStarted()}onExitXR(t){this.onWebXREnded()}onWebXRStarted(){this.onSessionStart.invoke()}onWebXREnded(){this.onSessionEnd.invoke()}}Ke([o(b)],ie.prototype,"onSessionStart",2);Ke([o(b)],ie.prototype,"onSessionEnd",2);const ot=P("debugbodytracking");class Cs extends h{constructor(){super(...arguments),this.jointPositions=new Map,this.size=new O(.01,.01,.01),this.hasWarnedForName=new Set}onEnable(){ot&&console.log(me.join(`
`))}onBeforeXR(t,i){i.optionalFeatures=i.optionalFeatures||[],i.optionalFeatures.includes("body-tracking")||i.optionalFeatures.push("body-tracking")}onUpdateXR(t){const i=t.xr.frame;if(!i)return;const r=t.xr.rig.gameObject,e=this.context.renderer.xr.getReferenceSpace();if(i.session&&"body"in i&&e){const n=i.body;if(!n)return;n.forEach(a=>{const l=i.getPose(a,e);if(!l)return;const p=l.transform.position,d=v();d.copy(p),d.x*=-1,d.z*=-1,r.localToWorld(d);const g=a.jointName;this.jointPositions.has(g)||this.jointPositions.set(g,new O),this.jointPositions.get(g).copy(d),ot&&M.DrawWireBox(d,this.size,16711680,void 0,!1);const S=v();S.copy(p),S.x*=-1,r.localToWorld(S);const F=a.jointName+"-flipped";this.jointPositions.has(F)||this.jointPositions.set(F,new O),this.jointPositions.get(F).copy(S),ot&&M.DrawWireBox(S,this.size,65280,void 0,!1);const at=me.indexOf(g);ot&&M.DrawLabel(S,at.toString(),.015,void 0,16777215,85),at<0&&(this.hasWarnedForName.has(g)||(this.hasWarnedForName.add(g),console.warn("Wrong name: "+g+" -> "+at+". Please report a bug.")))});for(const a of js){const l=this.jointPositions.get(a.from),p=this.jointPositions.get(a.to);if(l&&p){M.DrawLine(l,p,16776960,void 0,!1);const d=this.jointPositions.get(a.from+"-flipped"),g=this.jointPositions.get(a.to+"-flipped");d&&g&&M.DrawLine(d,g,65535,void 0,!1)}}}}}var Qe=(s=>(s[s.root=0]="root",s[s.hips=1]="hips",s[s["spine-lower"]=2]="spine-lower",s[s["spine-middle"]=3]="spine-middle",s[s["spine-upper"]=4]="spine-upper",s[s.chest=5]="chest",s[s.neck=6]="neck",s[s.head=7]="head",s[s["left-shoulder"]=8]="left-shoulder",s[s["left-scapula"]=9]="left-scapula",s[s["left-arm-upper"]=10]="left-arm-upper",s[s["left-arm-lower"]=11]="left-arm-lower",s[s["left-hand-wrist-twist"]=12]="left-hand-wrist-twist",s[s["right-shoulder"]=13]="right-shoulder",s[s["right-scapula"]=14]="right-scapula",s[s["right-arm-upper"]=15]="right-arm-upper",s[s["right-arm-lower"]=16]="right-arm-lower",s[s["right-hand-wrist-twist"]=17]="right-hand-wrist-twist",s[s["left-hand-palm"]=18]="left-hand-palm",s[s["left-hand-wrist"]=19]="left-hand-wrist",s[s["left-hand-thumb-metacarpal"]=20]="left-hand-thumb-metacarpal",s[s["left-hand-thumb-phalanx-proximal"]=21]="left-hand-thumb-phalanx-proximal",s[s["left-hand-thumb-phalanx-distal"]=22]="left-hand-thumb-phalanx-distal",s[s["left-hand-thumb-tip"]=23]="left-hand-thumb-tip",s[s["left-hand-index-metacarpal"]=24]="left-hand-index-metacarpal",s[s["left-hand-index-phalanx-proximal"]=25]="left-hand-index-phalanx-proximal",s[s["left-hand-index-phalanx-intermediate"]=26]="left-hand-index-phalanx-intermediate",s[s["left-hand-index-phalanx-distal"]=27]="left-hand-index-phalanx-distal",s[s["left-hand-index-tip"]=28]="left-hand-index-tip",s[s["left-hand-middle-phalanx-metacarpal"]=29]="left-hand-middle-phalanx-metacarpal",s[s["left-hand-middle-phalanx-proximal"]=30]="left-hand-middle-phalanx-proximal",s[s["left-hand-middle-phalanx-intermediate"]=31]="left-hand-middle-phalanx-intermediate",s[s["left-hand-middle-phalanx-distal"]=32]="left-hand-middle-phalanx-distal",s[s["left-hand-middle-tip"]=33]="left-hand-middle-tip",s[s["left-hand-ring-metacarpal"]=34]="left-hand-ring-metacarpal",s[s["left-hand-ring-phalanx-proximal"]=35]="left-hand-ring-phalanx-proximal",s[s["left-hand-ring-phalanx-intermediate"]=36]="left-hand-ring-phalanx-intermediate",s[s["left-hand-ring-phalanx-distal"]=37]="left-hand-ring-phalanx-distal",s[s["left-hand-ring-tip"]=38]="left-hand-ring-tip",s[s["left-hand-little-metacarpal"]=39]="left-hand-little-metacarpal",s[s["left-hand-little-phalanx-proximal"]=40]="left-hand-little-phalanx-proximal",s[s["left-hand-little-phalanx-intermediate"]=41]="left-hand-little-phalanx-intermediate",s[s["left-hand-little-phalanx-distal"]=42]="left-hand-little-phalanx-distal",s[s["left-hand-little-tip"]=43]="left-hand-little-tip",s[s["right-hand-palm"]=44]="right-hand-palm",s[s["right-hand-wrist"]=45]="right-hand-wrist",s[s["right-hand-thumb-metacarpal"]=46]="right-hand-thumb-metacarpal",s[s["right-hand-thumb-phalanx-proximal"]=47]="right-hand-thumb-phalanx-proximal",s[s["right-hand-thumb-phalanx-distal"]=48]="right-hand-thumb-phalanx-distal",s[s["right-hand-thumb-tip"]=49]="right-hand-thumb-tip",s[s["right-hand-index-metacarpal"]=50]="right-hand-index-metacarpal",s[s["right-hand-index-phalanx-proximal"]=51]="right-hand-index-phalanx-proximal",s[s["right-hand-index-phalanx-intermediate"]=52]="right-hand-index-phalanx-intermediate",s[s["right-hand-index-phalanx-distal"]=53]="right-hand-index-phalanx-distal",s[s["right-hand-index-tip"]=54]="right-hand-index-tip",s[s["right-hand-middle-metacarpal"]=55]="right-hand-middle-metacarpal",s[s["right-hand-middle-phalanx-proximal"]=56]="right-hand-middle-phalanx-proximal",s[s["right-hand-middle-phalanx-intermediate"]=57]="right-hand-middle-phalanx-intermediate",s[s["right-hand-middle-phalanx-distal"]=58]="right-hand-middle-phalanx-distal",s[s["right-hand-middle-tip"]=59]="right-hand-middle-tip",s[s["right-hand-ring-metacarpal"]=60]="right-hand-ring-metacarpal",s[s["right-hand-ring-phalanx-proximal"]=61]="right-hand-ring-phalanx-proximal",s[s["right-hand-ring-phalanx-intermediate"]=62]="right-hand-ring-phalanx-intermediate",s[s["right-hand-ring-phalanx-distal"]=63]="right-hand-ring-phalanx-distal",s[s["right-hand-ring-tip"]=64]="right-hand-ring-tip",s[s["right-hand-little-metacarpal"]=65]="right-hand-little-metacarpal",s[s["right-hand-little-phalanx-proximal"]=66]="right-hand-little-phalanx-proximal",s[s["right-hand-little-phalanx-intermediate"]=67]="right-hand-little-phalanx-intermediate",s[s["right-hand-little-phalanx-distal"]=68]="right-hand-little-phalanx-distal",s[s["right-hand-little-tip"]=69]="right-hand-little-tip",s[s["left-upper-leg"]=70]="left-upper-leg",s[s["left-lower-leg"]=71]="left-lower-leg",s[s["left-foot-ankle-twist"]=72]="left-foot-ankle-twist",s[s["left-foot-ankle"]=73]="left-foot-ankle",s[s["left-foot-subtalar"]=74]="left-foot-subtalar",s[s["left-foot-transverse"]=75]="left-foot-transverse",s[s["left-foot-ball"]=76]="left-foot-ball",s[s["right-upper-leg"]=77]="right-upper-leg",s[s["right-lower-leg"]=78]="right-lower-leg",s[s["right-foot-ankle-twist"]=79]="right-foot-ankle-twist",s[s["right-foot-ankle"]=80]="right-foot-ankle",s[s["right-foot-subtalar"]=81]="right-foot-subtalar",s[s["right-foot-transverse"]=82]="right-foot-transverse",s[s["right-foot-ball"]=83]="right-foot-ball",s))(Qe||{});const me=Object.values(Qe),js=[{from:"hips",to:"spine-lower"},{from:"spine-lower",to:"spine-middle"},{from:"spine-middle",to:"spine-upper"},{from:"spine-upper",to:"chest"},{from:"chest",to:"neck"},{from:"neck",to:"head"},{from:"chest",to:"left-shoulder"},{from:"left-shoulder",to:"left-scapula"},{from:"left-scapula",to:"left-arm-upper"},{from:"left-arm-upper",to:"left-arm-lower"},{from:"left-arm-lower",to:"left-hand-wrist-twist"},{from:"left-hand-wrist-twist",to:"left-hand-wrist"},{from:"left-hand-wrist",to:"left-hand-palm"},{from:"left-hand-wrist",to:"left-hand-thumb-metacarpal"},{from:"left-hand-thumb-metacarpal",to:"left-hand-thumb-phalanx-proximal"},{from:"left-hand-thumb-phalanx-proximal",to:"left-hand-thumb-phalanx-distal"},{from:"left-hand-thumb-phalanx-distal",to:"left-hand-thumb-tip"},{from:"left-hand-wrist",to:"left-hand-index-metacarpal"},{from:"left-hand-index-metacarpal",to:"left-hand-index-phalanx-proximal"},{from:"left-hand-index-phalanx-proximal",to:"left-hand-index-phalanx-intermediate"},{from:"left-hand-index-phalanx-intermediate",to:"left-hand-index-phalanx-distal"},{from:"left-hand-index-phalanx-distal",to:"left-hand-index-tip"},{from:"left-hand-wrist",to:"left-hand-middle-phalanx-metacarpal"},{from:"left-hand-middle-phalanx-metacarpal",to:"left-hand-middle-phalanx-proximal"},{from:"left-hand-middle-phalanx-proximal",to:"left-hand-middle-phalanx-intermediate"},{from:"left-hand-middle-phalanx-intermediate",to:"left-hand-middle-phalanx-distal"},{from:"left-hand-middle-phalanx-distal",to:"left-hand-middle-tip"},{from:"left-hand-wrist",to:"left-hand-ring-metacarpal"},{from:"left-hand-ring-metacarpal",to:"left-hand-ring-phalanx-proximal"},{from:"left-hand-ring-phalanx-proximal",to:"left-hand-ring-phalanx-intermediate"},{from:"left-hand-ring-phalanx-intermediate",to:"left-hand-ring-phalanx-distal"},{from:"left-hand-ring-phalanx-distal",to:"left-hand-ring-tip"},{from:"left-hand-wrist",to:"left-hand-little-metacarpal"},{from:"left-hand-little-metacarpal",to:"left-hand-little-phalanx-proximal"},{from:"left-hand-little-phalanx-proximal",to:"left-hand-little-phalanx-intermediate"},{from:"left-hand-little-phalanx-intermediate",to:"left-hand-little-phalanx-distal"},{from:"left-hand-little-phalanx-distal",to:"left-hand-little-tip"},{from:"chest",to:"right-shoulder"},{from:"right-shoulder",to:"right-scapula"},{from:"right-scapula",to:"right-arm-upper"},{from:"right-arm-upper",to:"right-arm-lower"},{from:"right-arm-lower",to:"right-hand-wrist-twist"},{from:"right-hand-wrist-twist",to:"right-hand-wrist"},{from:"right-hand-wrist",to:"right-hand-palm"},{from:"right-hand-wrist",to:"right-hand-thumb-metacarpal"},{from:"right-hand-thumb-metacarpal",to:"right-hand-thumb-phalanx-proximal"},{from:"right-hand-thumb-phalanx-proximal",to:"right-hand-thumb-phalanx-distal"},{from:"right-hand-thumb-phalanx-distal",to:"right-hand-thumb-tip"},{from:"right-hand-wrist",to:"right-hand-index-metacarpal"},{from:"right-hand-index-metacarpal",to:"right-hand-index-phalanx-proximal"},{from:"right-hand-index-phalanx-proximal",to:"right-hand-index-phalanx-intermediate"},{from:"right-hand-index-phalanx-intermediate",to:"right-hand-index-phalanx-distal"},{from:"right-hand-index-phalanx-distal",to:"right-hand-index-tip"},{from:"right-hand-wrist",to:"right-hand-middle-metacarpal"},{from:"right-hand-middle-metacarpal",to:"right-hand-middle-phalanx-proximal"},{from:"right-hand-middle-phalanx-proximal",to:"right-hand-middle-phalanx-intermediate"},{from:"right-hand-middle-phalanx-intermediate",to:"right-hand-middle-phalanx-distal"},{from:"right-hand-middle-phalanx-distal",to:"right-hand-middle-tip"},{from:"right-hand-wrist",to:"right-hand-ring-metacarpal"},{from:"right-hand-ring-metacarpal",to:"right-hand-ring-phalanx-proximal"},{from:"right-hand-ring-phalanx-proximal",to:"right-hand-ring-phalanx-intermediate"},{from:"right-hand-ring-phalanx-intermediate",to:"right-hand-ring-phalanx-distal"},{from:"right-hand-ring-phalanx-distal",to:"right-hand-ring-tip"},{from:"right-hand-wrist",to:"right-hand-little-metacarpal"},{from:"right-hand-little-metacarpal",to:"right-hand-little-phalanx-proximal"},{from:"right-hand-little-phalanx-proximal",to:"right-hand-little-phalanx-intermediate"},{from:"right-hand-little-phalanx-intermediate",to:"right-hand-little-phalanx-distal"},{from:"right-hand-little-phalanx-distal",to:"right-hand-little-tip"},{from:"hips",to:"left-upper-leg"},{from:"left-upper-leg",to:"left-lower-leg"},{from:"left-lower-leg",to:"left-foot-ankle-twist"},{from:"left-foot-ankle-twist",to:"left-foot-ankle"},{from:"left-foot-ankle",to:"left-foot-subtalar"},{from:"left-foot-subtalar",to:"left-foot-transverse"},{from:"left-foot-transverse",to:"left-foot-ball"},{from:"hips",to:"right-upper-leg"},{from:"right-upper-leg",to:"right-lower-leg"},{from:"right-lower-leg",to:"right-foot-ankle-twist"},{from:"right-foot-ankle-twist",to:"right-foot-ankle"},{from:"right-foot-ankle",to:"right-foot-subtalar"},{from:"right-foot-subtalar",to:"right-foot-transverse"},{from:"right-foot-transverse",to:"right-foot-ball"}];var Ss=Object.defineProperty,Ds=Object.getOwnPropertyDescriptor,Ts=(s,t,i,r)=>{for(var e=r>1?void 0:r?Ds(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Ss(t,i,e),e};class re extends h{constructor(){super(...arguments),this.destroyTarget=!1,this._startTime=0}awake(){if(this._rigidbody=this.gameObject.getComponentInParent(D)||void 0,this._rigidbody){const t=this.gameObject.getComponentsInChildren(mt);for(const i of t){const r=m.addComponent(i.gameObject,Es);r.rigidBody=this._rigidbody,r.arrow=this,r.audioOnImpact=this.audioOnImpact,r.destroyTarget=this.destroyTarget}}this._startTime=this.context.time.time}onBeforeRender(){if(this.context.time.time-this._startTime>5){this.gameObject.destroy();return}if(this._rigidbody){const t=this._rigidbody.getVelocity();if(t.lengthSq()>0){const i=v().set(t.x,t.y,t.z).normalize(),r=mi();r.setFromUnitVectors(v(0,0,1),i),this.gameObject.quaternion.copy(r)}}}}Ts([o(N)],re.prototype,"audioOnImpact",2);class Es extends h{constructor(){super(...arguments),this.destroyTarget=!1}onCollisionEnter(t){var i,r;if(this.arrow)if((i=this.audioOnImpact)==null||i.stop(),(r=this.audioOnImpact)==null||r.play(),this.destroyTarget)t.gameObject.destroy(),this.arrow.gameObject.destroy();else{t.gameObject.attach(this.arrow.gameObject),t.rigidBody instanceof D&&t.rigidBody.applyImpulse(t.gameObject.position.clone().multiply(this.rigidBody.getVelocity()),!0);const e=this.rigidBody.gameObject.getComponentsInChildren(mt);for(const n of e)n.destroy();this.rigidBody.destroy(),this.arrow.destroy()}}}var Ms=Object.defineProperty,$s=Object.getOwnPropertyDescriptor,T=(s,t,i,r)=>{for(var e=r>1?void 0:r?$s(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Ms(t,i,e),e};const ue=P("debugarrow");class j extends h{constructor(){super(...arguments),this.power=1.5,this.drawMaxPhysicalDistance=.47269,this.drawMinPhysicalDistance=.1132593,this._tempLookMatrix=new Di,this._tempLookRot=new Mt,this._lastShotTimestamp=Number.MIN_SAFE_INTEGER,this._isAiming=!1,this._bowController=void 0,this._stringController=void 0,this._controllerFollow=null,this._aimingPointerStartPos=new O,this._initialBowObjectRotation=new Mt,this._initialBowObjectPosition=new O,this._screenDragRaycaster=new Ti,this._screenDragPlane=new Ei,this._screenDragRayLine=new Mi,this.onDown=t=>{t.origin instanceof ce?t.button===0&&(this._bowController===void 0?(this._bowController=t.origin.index,this.bowObject.quaternion.copy(this._initialBowObjectRotation)):this._stringController===void 0&&(this._stringController=t.origin.index),this._bowController===this._stringController&&(this._stringController=void 0),this._controllerFollow&&(this._controllerFollow.side=this._bowController,this._controllerFollow.enabled=this._bowController!==void 0),this._isAiming=this._stringController!==void 0):t.button===0&&(this._isAiming=!0,this._stringPointerId=t.pointerId,this.getScreenDragPoint(t.pointerId,this._aimingPointerStartPos))},this.onRelease=t=>{var i;if(t.button===0){if(t.origin instanceof ce){const r=t.origin;if(this._isAiming&&r.index===this._stringController&&r.index!==this._bowController&&typeof this._bowController=="number"){const e=(i=ht.active)==null?void 0:i.getController(this._bowController);if(r&&e){const n=r.gripWorldPosition;if(n){const a=e.gripWorldPosition.clone().sub(n);let l=e.object.worldPosition.distanceTo(r.object.worldPosition);l-=this.drawMinPhysicalDistance;const p=w.clamp01(l/this.drawMaxPhysicalDistance)*this.power;a.normalize().multiplyScalar(p),this.shoot(n,a),ue&&M.DrawArrow(n,a.clone().add(n),16776960,1)}}}r.index===this._bowController&&(this._bowController=void 0),r.index===this._stringController&&(this._stringController=void 0),this._isAiming=this._bowController!==void 0&&this._stringController!==void 0,this._controllerFollow&&(this._controllerFollow.enabled=this._bowController!==void 0)}else{const r=this._aimingPointerStartPos,e=this.getScreenDragPoint(this._stringPointerId,v()),n=this.arrowSpawnSpot.getWorldPosition(v()),a=this.bowObject.getWorldDirection(v()).multiplyScalar(-1),l=r.distanceTo(e),p=w.clamp01(l/this.drawMaxPhysicalDistance)*this.power;a.normalize().multiplyScalar(p),this.shoot(n,a)}this._stringPointerId=void 0}}}get _hasControllers(){var t;return(((t=this.context.xr)==null?void 0:t.controllers.length)??0)>0}awake(){var t;(t=this.arrowPrefab)!=null&&t.asset&&(this.arrowPrefab.asset.visible=!1)}async onEnable(){var t;await((t=this.arrowPrefab)==null?void 0:t.loadAssetAsync()),this._isAiming=!1,this._controllerFollow=this.bowObject.getComponentInParent(fi)||null,this._initialBowObjectRotation=this.bowObject.quaternion.clone(),this._initialBowObjectPosition=this.bowObject.position.clone(),this._screenDragPlane.setFromNormalAndCoplanarPoint(v(0,1,-.2),this.bowObject.worldPosition),this.context.input.addEventListener("pointerdown",this.onDown),this.context.input.addEventListener("pointerup",this.onRelease),this.setupArrowInstances()}onDisable(){this._isAiming=!1,this.context.input.removeEventListener("pointerdown",this.onDown),this.context.input.removeEventListener("pointerup",this.onRelease)}onLeaveXR(){this.bowObject.quaternion.copy(this._initialBowObjectRotation),this.bowObject.position.copy(this._initialBowObjectPosition)}getPointerDistanceTo(t,i){const r=this.context.input.getPointerPosition(i);return t.distanceTo(r)}async setupArrowInstances(){var i,r,e;if(!this.arrowPrefab||!this.arrowSpawnSpot||this._drawingArrow)return;const t=await this.arrowPrefab.instantiate({parent:this.arrowSpawnSpot});t&&(t.visible=!0,t.worldScale=v(1,1,1),this._drawingArrow=t,(i=t.getComponent(re))==null||i.destroy(),(r=t.getComponent(D))==null||r.destroy(),(e=t.getComponentInChildren(Ut))==null||e.destroy(),t.getComponentsInChildren(mt).forEach(n=>n.destroy()))}async shoot(t,i){var d,g;if(!this.arrowPrefab)return;this._lastShotTimestamp=this.context.time.time;const r=t.clone(),e=r.clone().add(i),n=Math.pow(i.length()+.5,2),a=i.clone().normalize(),l=await this.arrowPrefab.instantiate({parent:this.context.scene});if(!l){console.error("Failed to instantiate arrow prefab, please check that objects are assigned correctly.");return}l.worldPosition=r,l.lookAt(e),l.visible=!0;const p=l.getComponent(D);p&&(p.isKinematic=!1,p.autoMass=!1,p.mass=.05,(d=this.sound)==null||d.stop(),(g=this.sound)==null||g.play(),await Ht(1),p.applyImpulse(a.multiplyScalar(n),!0))}getScreenDragPoint(t,i){const r=this.context.input.getPointerPositionRC(t);this._screenDragRaycaster.setFromCamera(r,this.context.mainCamera);const e=this._screenDragRaycaster.ray;return this._screenDragRayLine.set(e.origin,e.direction.multiplyScalar(1e5)),this._screenDragPlane.intersectLine(this._screenDragRayLine,i)||i.set(0,0,0),ue&&M.DrawWireSphere(i,.01,16711680,1),i}onBeforeRender(){if(!this.animationComponent||!this.bowObject)return;if(!this._mixer){this._mixer=new $i(this.bowObject);const p=this.animationComponent.animations.at(0);p&&(this._animation=this._mixer.clipAction(p))}const t=.1;let i=0;const r=v(),e=v(),n=v(this.bowObject.worldUp);if(this._hasControllers){if(!this._isAiming)i=0,this._lastShotTimestamp=this.context.time.time;else if(this.context.xr&&this.context.xr.controllers.length>1&&this._bowController!==void 0&&this._stringController!==void 0){const p=this.context.xr.controllers[this._stringController],d=this.context.xr.controllers[this._bowController];if(!p||!d)return;r.copy(p.gripWorldPosition),e.copy(d.gripWorldPosition)}}else this._stringPointerId!==void 0&&(e.copy(this._aimingPointerStartPos),r.copy(this.getScreenDragPoint(this._stringPointerId,v())));if(this._isAiming&&r.dot(r)>0&&e.dot(e)>0){let p=r.distanceTo(e);i=w.clamp01((p-this.drawMinPhysicalDistance)/this.drawMaxPhysicalDistance),p>.025&&(this._tempLookMatrix.lookAt(r,e,n),this._tempLookRot.setFromRotationMatrix(this._tempLookMatrix),this.bowObject.worldQuaternion=this._tempLookRot)}this.drawProgression&&(i=this.drawProgression.evaluate(i)),!this._isAiming&&!this._hasControllers&&(i=.25),this._animation.timeScale=0;const a=w.lerp(this._animation.time,i,this.context.time.deltaTime/t),l=this._animation.time;if(this._animation.time=a,Math.abs(a-l)>Number.EPSILON&&(this._animation.setEffectiveWeight(1),this._animation.play()),this._mixer.update(this.context.time.deltaTime),this._drawingArrow){let d=(this.context.time.time-this._lastShotTimestamp)/.3;d=this.easeInOutSine(w.clamp01(d)),this._drawingArrow.worldScale=v(1,1,1).multiplyScalar(d)}}easeInOutSine(t){return w.clamp01(-.5*(Math.cos(Math.PI*t)-1))}}T([o(C)],j.prototype,"bowObject",2);T([o(dt)],j.prototype,"animationComponent",2);T([o(ge)],j.prototype,"arrowPrefab",2);T([o(C)],j.prototype,"arrowSpawnSpot",2);T([o()],j.prototype,"power",2);T([o(ui)],j.prototype,"drawProgression",2);T([o()],j.prototype,"drawMaxPhysicalDistance",2);T([o()],j.prototype,"drawMinPhysicalDistance",2);T([o(N)],j.prototype,"sound",2);var As=Object.defineProperty,Is=Object.getOwnPropertyDescriptor,Ls=(s,t,i,r)=>{for(var e=r>1?void 0:r?Is(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&As(t,i,e),e};class Ye extends h{start(){this._meshRenderer=this.gameObject.getComponentInChildren(gi)}onDestroy(){if(this.gameObject.visible&&this.particleSystem){if(this.particleSystem.shape.shapeType===St.MeshRenderer&&this._meshRenderer&&!xe(this._meshRenderer.gameObject)){this.particleSystem.shape.shapeType=St.MeshRenderer,this.particleSystem.shape.setMesh(this._meshRenderer),this.particleSystem.play();return}this.particleSystem.shape.shapeType=St.Sphere,this.particleSystem.worldPosition=this.gameObject.worldPosition,this.particleSystem.play()}}}Ls([o(Ut)],Ye.prototype,"particleSystem",2);var Fs=Object.defineProperty,Ns=Object.getOwnPropertyDescriptor,zs=(s,t,i,r)=>{for(var e=r>1?void 0:r?Ns(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Fs(t,i,e),e};class Ze extends h{constructor(){super(...arguments),this._instances=new Array}awake(){var t,i;if(!((t=this.prefabs)!=null&&t.length)||((i=this.prefabs)==null?void 0:i.length)===0){console.warn("BowTargetSpawner start: no prefab set"),this.enabled=!1;return}this.prefabs.forEach(r=>r.visible=!1)}update(){var i;if(!((i=this.prefabs)!=null&&i.length))return;const t=v();for(let r=this._instances.length-1;r>=0;r--){const e=this._instances[r];xe(e.instance)?this._instances.splice(r,1):(t.setScalar(e.scale),e.instance.scale.lerp(t,this.context.time.deltaTime))}if(this.context.time.frame%20===0&&Math.random()>.5){const r=this.worldPosition;r.x+=Math.random()*12-6,r.y+=Math.random()*3,r.z+=Math.random()*6;const e=Math.random()*3+.5,n=this.prefabs[Math.floor(Math.random()*this.prefabs.length)],a=bi(n,{parent:this.scene,position:r.clone(),scale:new O(.01,.01,.01),keepWorldPosition:!0});a.visible=!0,this._instances.push({instance:a,scale:e}),setTimeout(()=>{a.destroy()},7e3),Ht(1).then(()=>{const l=a.getComponentInChildren(D);l&&(l.gravityScale=.2+Math.random()*.3,l.mass=2,l.autoMass=!1),l==null||l.setAngularVelocity(w.random(-2,2),w.random(-2,2),w.random(-2,2)),l==null||l.applyImpulse({x:0,y:5+Math.random()*12,z:0})})}}}zs([o(C)],Ze.prototype,"prefabs",2);class Us extends h{awake(){this.context.renderer.toneMapping=Ai,de.occlusion_fragment=de.occlusion_fragment.replace("gl_FragColor *= 1.0 - occlusion;",`
float depthMm = Depth_GetCameraDepthInMeters(depthColor, depthUv, arrayIndex);

// requires also patching ShaderChunk.occlusion_pars_fragment and adding some noise function
// float noise = snoise(gl_FragCoord.xy * 0.005);
// depthMm += noise * 0.002;

float absDistance = abs(assetDepthM - depthMm);
float v = 0.0025;
absDistance = saturate(v - absDistance) / v;

gl_FragColor.rgb += vec3(absDistance * 2.0, absDistance * 2.0, absDistance * 12.0);
gl_FragColor = mix(gl_FragColor, vec4(0.0, 0.0, 0.0, 0.0), occlusion * 0.7);
`)}}class Vs extends h{constructor(){super(...arguments),this.interval=-1,this.supportsAR=!1,this.supportsVR=!1}async onEnable(){this.log(!0),this.interval=setInterval(()=>this.log(),500),this.supportsAR=await ht.isARSupported(),this.supportsVR=await ht.isVRSupported()}onDisable(){clearInterval(this.interval)}async log(t=!1){t&&(console.log("UserAgent",window.navigator.userAgent),console.log("isMobileDevice",x.isMobileDevice()),console.log("isiOSDevice",x.isiOS()),console.log("isMozillaXR",x.isMozillaXR()),console.log("isSafari",x.isSafari()),console.log("isQuest",x.isQuest()),console.log("isMacOS",x.isMacOS()),console.log("isVisionOS",x.isVisionOS())),u("AR: "+i(this.supportsAR)+", VR: "+i(this.supportsVR)+", QuickLook: "+i(x.supportsQuickLookAR())),x.isMobileDevice()?x.isiOS()?u("iOS "):window.navigator.userAgent.indexOf("Android")>-1?u("Android "):u("Other Mobile "):x.isDesktop()?u("Desktop "):u("Other Device "),x.isMobileDevice()&&x.isiOS()&&x.isSafari()?u("Safari "):x.isMozillaXR()?u("Mozilla XR "):x.isQuest()?u("Quest "):window.navigator.userAgent.indexOf("Chrome")>-1?u("Chrome "):u("Other Browser "),u("UserAgent: "+window.navigator.userAgent);function i(r){return r?"":""}}}class Ws extends h{onEnable(){const t=m.findObjectOfType(Gt);t&&(t.anchoringType="plane",t.planeAnchoringAlignment="vertical")}}var Gs=Object.defineProperty,Hs=Object.getOwnPropertyDescriptor,tt=(s,t,i,r)=>{for(var e=r>1?void 0:r?Hs(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Gs(t,i,e),e};class U extends h{constructor(){super(...arguments),this.distance=.5,this.fadeDuration=1,this.targetState=!0,this.hideOnStart=!0,this.tempVector=new O}start(){this.hideOnStart&&!x.isiOS()&&this.target.scale.set(0,0,0)}update(){this.tempVector.copy(this.context.mainCameraComponent.worldPosition),this.tempVector.sub(this.worldPosition).length()<this.distance&&(this.enabled=!1)}createBehaviours(t,i,r){if(i.uuid===this.gameObject.uuid){const e=this.target?this.target:this.gameObject;this.hideOnStart&&t.addBehavior(new $("SetActiveOnProximity_active_"+this.gameObject.name,A.sceneStartTrigger(),_.fadeAction(e,0,!this.targetState))),t.addBehavior(new $("SetActiveOnProximity_"+this.gameObject.name,A.proximityToCameraTrigger(this.gameObject,this.distance),_.fadeAction(e,this.fadeDuration,this.targetState)))}}}tt([o(m)],U.prototype,"target",2);tt([o()],U.prototype,"distance",2);tt([o()],U.prototype,"fadeDuration",2);tt([o()],U.prototype,"targetState",2);tt([o()],U.prototype,"hideOnStart",2);var Rs=Object.defineProperty,qs=Object.getOwnPropertyDescriptor,se=(s,t,i,r)=>{for(var e=r>1?void 0:r?qs(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Rs(t,i,e),e};class _t extends h{constructor(){super(...arguments),this.getCloseClip="",this.distance=.5,this.lastDistance=void 0}update(){const t=this.gameObject.worldPosition.distanceTo(this.context.mainCameraComponent.worldPosition);this.lastDistance!==void 0&&t<this.distance&&this.lastDistance>=this.distance&&this.target.play(this.getCloseClip),this.lastDistance=t}createBehaviours(t,i,r){if(i.uuid===this.gameObject.uuid){const e=this.target?this.target.gameObject:this.gameObject,n=r.extensions.find(p=>p instanceof xi);if(!n){console.warn("No AnimationExtension found",r.extensions);return}let a;const l=pe.getAndRegisterAnimationSequences(n,e,this.getCloseClip);if(l)a=pe.getActionForSequences(e,l.animationSequence,l.animationLoopAfterSequence,l.randomTimeOffset);else{console.warn("No animation sequence found for "+this.getCloseClip,l);return}t.addBehavior(new $("PlayAnimationOnProximity_"+this.gameObject.name,A.proximityToCameraTrigger(this.gameObject,this.distance),a));return}}}se([o(Wt)],_t.prototype,"target",2);se([o()],_t.prototype,"getCloseClip",2);se([o()],_t.prototype,"distance",2);var Ks=Object.defineProperty,Qs=Object.getOwnPropertyDescriptor,Ot=(s,t,i,r)=>{for(var e=r>1?void 0:r?Qs(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Ks(t,i,e),e};class et extends h{constructor(){super(...arguments),this.distance=.5,this.targetState=!0}createBehaviours(t,i,r){}async afterSerialize(t,i){}}Ot([o(N)],et.prototype,"target",2);Ot([o(URL)],et.prototype,"clip",2);Ot([o()],et.prototype,"distance",2);Ot([o()],et.prototype,"targetState",2);var Ys=Object.defineProperty,Zs=Object.getOwnPropertyDescriptor,V=(s,t,i,r)=>{for(var e=r>1?void 0:r?Zs(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&Ys(t,i,e),e};class yt{constructor(){this.contents=[],this.negativeContents=[],this.triggers=[]}}V([o(C)],yt.prototype,"contents",2);V([o(C)],yt.prototype,"negativeContents",2);V([o(C)],yt.prototype,"triggers",2);class Pt extends h{constructor(){super(...arguments),this.elements=[],this.fadeDuration=.2,this.selectFirstOnStart=!0,this._allTargets=[],this._allTriggers=[]}get currentIndex(){return this._currentIndex}get defaultVariant(){const t=this.selectFirstOnStart?this.elements.at(0):void 0;return this._currentIndex!==void 0?this.elements.at(this._currentIndex):t}awake(){this.elements.forEach(t=>{t.contents=t.contents.filter(i=>i),t.triggers=t.triggers.filter(i=>i)}),this.elements.forEach(t=>{var i;return(i=t.contents)==null?void 0:i.forEach(r=>this._allTargets.push(r))}),this.elements.forEach(t=>{var i;return(i=t.triggers)==null?void 0:i.forEach(r=>this._allTriggers.push(r))}),this.setupForRuntime()}setupForRuntime(){this.elements.forEach((t,i)=>{var r;(r=t.triggers)==null||r.forEach(e=>{const n=vi(e,zt);n.onClick??(n.onClick=new b),n.onClick.addEventListener(()=>{this._currentIndex=i,this._allTargets.forEach(a=>{a.visible=t.contents.includes(a)})})})}),this.selectDefault()}selectDefault(){var i;const t=((i=this.defaultVariant)==null?void 0:i.contents)??[];this._allTargets.forEach(r=>{r.visible=t.includes(r)})}createBehaviours(t,i,r){i.uuid===this.gameObject.uuid&&this.setupForUSDZ(t)}beforeCreateDocument(t,i){this._allTargets.forEach(r=>{r.visible=!0})}async afterSerialize(t,i){await Ht(3),this.selectDefault()}setupForUSDZ(t){var e;this.elements.forEach(n=>{var a;(a=n.triggers)==null||a.forEach(l=>{const p=n.contents,d=this._cloneArray(this._allTargets).filter(g=>!p.includes(g));p.length>=0&&t.addBehavior(new $(`EnableObject_${l.uuid}`,A.tapTrigger(l),_.fadeAction(p,this.fadeDuration,!0))),d.length>=0&&t.addBehavior(new $(`DisableObject_${l.uuid}`,A.tapTrigger(l),_.fadeAction(d,this.fadeDuration,!1)))})});const i=((e=this.defaultVariant)==null?void 0:e.contents)??[],r=this._cloneArray(this._allTargets).filter(n=>!i.includes(n));t.addBehavior(new $(`HideOnStart_${this.guid}`,A.sceneStartTrigger(),_.fadeAction(r,0,!1)))}_cloneArray(t){const i=new Array(t.length);return t.forEach((r,e)=>i[e]=r),i}}V([o(yt)],Pt.prototype,"elements",2);V([o()],Pt.prototype,"fadeDuration",2);V([o()],Pt.prototype,"selectFirstOnStart",2);var ks=Object.defineProperty,Bs=Object.getOwnPropertyDescriptor,E=(s,t,i,r)=>{for(var e=r>1?void 0:r?Bs(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&ks(t,i,e),e};class W{constructor(){this.name="Name"}}E([o()],W.prototype,"name",2);E([o(ut)],W.prototype,"icon",2);E([o(b)],W.prototype,"click",2);class G{constructor(){this.title="Title",this.items=[]}}E([o()],G.prototype,"title",2);E([o(ut)],G.prototype,"icon",2);E([o(b)],G.prototype,"select",2);E([o(b)],G.prototype,"deselect",2);E([o(W)],G.prototype,"items",2);class it extends h{constructor(){super(...arguments),this.categories=[]}awake(){document.body.insertAdjacentHTML("afterbegin",`<style>${rn}</style>`),document.body.insertAdjacentHTML("afterbegin",en),this.mainmenu=document.querySelector(".mainmenu"),this.submenuRoot=document.querySelector(".submenu-wrapper"),this.submenu=document.querySelector(".submenu"),this.submenuTitle=document.querySelector(".submenu-title"),this.submenuContent=document.querySelector(".submenu-content"),this.categories.forEach(t=>this.addCategory(t)),this.hideSubmenu()}addNewCategory(t){this.categories.push(t),this.addCategory(t)}addCategory(t){if(!this.mainmenu)return;const i=Js(t);this.mainmenu.appendChild(i),i.onclick=()=>{this.selectedCategory===t?this.hideSubmenu():this.showSubmenu(t)}}addItem(t){if(!this.submenuContent)return;const i=tn(t);this.submenuContent.appendChild(i),i.onclick=()=>{var r;(r=t.click)==null||r.invoke()}}showSubmenu(t){var i,r,e,n;for(this.selectedCategory=t,(r=(i=this.selectedCategory)==null?void 0:i.select)==null||r.invoke(),this.submenuTitle&&(this.submenuTitle.textContent=t.title);(e=this.submenuContent)!=null&&e.firstChild;)this.submenuContent.removeChild(this.submenuContent.firstChild);t.items.forEach(a=>this.addItem(a)),(n=this.submenuRoot)==null||n.classList.remove("close")}hideSubmenu(){var t,i,r,e,n;for((i=(t=this.selectedCategory)==null?void 0:t.deselect)==null||i.invoke(),this.selectedCategory=void 0;(r=this.submenuContent)!=null&&r.firstChild;)(e=this.submenuContent)==null||e.removeChild(this.submenuContent.firstChild);(n=this.submenuRoot)==null||n.classList.add("close")}}E([o(G)],it.prototype,"categories",2);const Xs="https://upload.wikimedia.org/wikipedia/commons/2/21/City_locator_4.svg",Js=s=>{var i;const t=document.createElement("button");return t.classList.add("room"),t.classList.add("open-submenu"),t.innerHTML=`
        <button class="open-submenu">
            <span class="icon">
                <img src=${((i=s.icon)==null?void 0:i.url)??Xs} alt=${s.title??"?"}>
            </span>
        </button>
    `,t},tn=s=>{var e;const t=document.createElement("button");t.classList.add("submenu-button");const i=`
        <img src=${(e=s.icon)==null?void 0:e.url} alt=${s.name??"?"}>
    `,r=`
        <a>${s.name}</a>
    `;return s.icon&&(t.innerHTML+=i),t.innerHTML+=r,t},en=`
  <div class="mainmenu">
    <!-- Content -->
  </div>

  <div class="submenu-wrapper">
    <h2 class="submenu-title"></h2>
    <div class="submenu">
        <div class="submenu-content">
            <!-- Content -->
        </div>
    </div>
  </div>
`,rn=`
.mainmenu {
    position: absolute;
    top: 16px;
    right: 16px;
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 54px;
    height: auto;
    background: rgba(229, 230, 233, 0.8);
    border-radius: 27px;
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    box-shadow: 0 0 4px rgba(2, 2, 43, 0.2);
    z-index: 1;
    padding-top: 6px;

    /* default font settings */
    font-size: 1rem;
    font-family: 'Roboto Flex', sans-serif;
    /* font-optical-sizing: auto; */
    /* font-variation-settings: "width" 100; */
    color: rgb(40, 40, 40);
}

.mainmenu button {
    width: 42px;
    height: 42px;
    border: none;
    border-radius: 50%;
    margin-bottom: 4px;
    background: transparent;
    transition: background-color 0.5s;
    outline: rgba(0, 0, 0, 0) 1px solid;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
}

.mainmenu button.active,
.mainmenu button:hover {
    background: rgba(245, 245, 245, .8);
    transition: all 0.1s linear .02s;
    outline: rgba(0, 0, 0, .05) 1px solid;
}

.mainmenu button.active img,
.mainmenu button:hover img
{
    /* filter: invert(100%) sepia(0%) saturate(7478%) hue-rotate(317deg) brightness(109%) contrast(99%); */
}

.mainmenu button img {
    width: 32px;
    height: 32px;
}

.mainmenu button .state-icon {
    position: absolute;
    top: 9px;
    left: 11px;
    width: 32px; 
    height: 32px; 
    background-size: cover;
    background-repeat: no-repeat;
    pointer-events: none; 
    filter: invert(61%) sepia(85%) saturate(1169%) hue-rotate(92deg) brightness(92%) contrast(86%);
}

.mainmenu button.active .state-icon,
.mainmenu button:hover .state-icon
{
    filter: invert(61%) sepia(85%) saturate(1169%) hue-rotate(92deg) brightness(92%) contrast(86%);
}

/*Submenu*/
.submenu-wrapper {
    position: absolute;
    top: 16px;
    right: calc(70px + 10px);
    width: 333px;
    max-height: 60vh;
    padding: 22px;
    z-index: 1;

    background: #ffffff5c;
    border: 1px solid rgba(255, 255, 255, .1);
    border-radius: 1.1999rem;
    outline: rgb(0 0 0 / 5%) 1px solid;
    box-shadow: 0px 7px 0.5rem 0px rgb(0 0 0 / 6%), inset 0px 0px 1.3rem rgba(0, 0, 0, .05);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);

    overflow: hidden;
}

.submenu {
    overflow-x: hidden;
    overflow-y: scroll;
    max-height: calc(60vh - 22px * 2);
    font-family: 'Roboto Flex', sans-serif;
}

/* width */
.submenu::-webkit-scrollbar {
    scrollbar-color: #ff0000;
    width: 5px;
}

/* Track */
.submenu::-webkit-scrollbar-track {
    background: #8880;
    margin-right: 20px;
}

/* Handle */
.submenu::-webkit-scrollbar-thumb {
    background: #8888;
    border-radius: 10px; /* Rounded corners */
    margin: 0 8px; /* Offset the track to move the thumb left */
}

/* Handle on hover */
.submenu::-webkit-scrollbar-thumb:hover {
    background: #555A;
}

.submenu-title {
    color: #282828;
    font-size: 22px;
    font-weight: 800;
    line-height: 32px;
    margin-bottom: 16px;
    margin-top: 0px;
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
    border-bottom: 1px solid rgba(40, 40, 40, .4);
    font-family: 'Roboto Flex', sans-serif;
}

.submenu-button {
    height: 1.8rem;
    display: flex;
    align-items: center;
    margin-bottom: 8px;
    font-size: 1rem;
    line-height: 32px;
    border: none;
    cursor: pointer;
    font-family: 'Roboto Flex', sans-serif;
    font-weight: 200;
    width: 100%;
    
    background: transparent;
    outline: rgba(0, 0, 0, 0) 1px solid;
    border-radius: 0.8rem;
}

.submenu-button:hover { 
    background: rgba(245, 245, 245, .8);
    transition: all 0.1s linear .02s;
    outline: rgba(0, 0, 0, .05) 1px solid;
}

.submenu-button img {
    width: 32px;
    height: 32px;
    margin-right: 6px;
    margin-left: -6px;
}

.submenu-button a {
    color: #282828;
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
}

.submenu-content img {
    max-width: 100%;
    height: auto;
    margin-right: 6px;
}

.special {
    display: flex;
    align-items: center;
    margin-top: 16px;
    font-size: 13px;
    line-height: 20px;
    color: #919191;
    border: none;
    background: none;
}

.special img {
    width: 16px;
    height: 16px;
    filter: invert(61%) sepia(85%) saturate(1169%) hue-rotate(92deg) brightness(92%) contrast(86%);
}

.submenu-wrapper.close {
    display: none;
}

@media screen and (max-width: 768px) {
    .mainmenu {
        width: 42px;
        height: auto;
        padding-bottom: 2px;
    }

    .mainmenu button {
        width: 32px;
        height: 32px;
    }

    .mainmenu button img {
        width: 24px;
        height: 24px;
    }

    .mainmenu button .state-icon {
        position: absolute;
        top: 9px;
        left: 9px;
        width: 24px; 
        height: 24px; 
    }

    .submenu-wrapper {
        right: calc(60px + 5px);
        width: 256px;
        border-radius: 21px;
        padding: 16px;
        max-height: 40vh;
    }

    .submenu {
        max-height: calc(40vh - 16px * 2);
    }

    .submenu-title {
        font-size: 18px;
        line-height: 28px;
        margin-bottom: 10px;
    }

    .submenu-button {
        margin-bottom: 6px;
        /* font-size: 1.3rem; */
        line-height: 24px;
    }

    .submenu-button img {
        width: 24px;
        height: 24px;
    }

    .special {
        margin-top: 10px;
        font-size: 11px;
    }

    .special img {
        width: 10px;
        height: 10px;
    }
}`;var sn=Object.defineProperty,nn=Object.getOwnPropertyDescriptor,H=(s,t,i,r)=>{for(var e=r>1?void 0:r?nn(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&sn(t,i,e),e};class ne{}H([o(zt)],ne.prototype,"button",2);H([o(Q)],ne.prototype,"label",2);class rt extends h{constructor(){super(...arguments),this.categoryName="",this.data=[]}awake(){var i;this.galleryUI??(this.galleryUI=ve(it));const t=(i=this.galleryUI)==null?void 0:i.categories.find(r=>r.title===this.categoryName);t&&this.data.forEach(r=>{var n,a;const e=new W;e.name=((n=r.label)==null?void 0:n.text)||"",e.icon=this.icon,e.click=new b,(a=e.click)==null||a.addEventListener(()=>{var l,p;(p=(l=r.button)==null?void 0:l.onClick)==null||p.invoke()}),t.items.push(e)})}}H([o(it)],rt.prototype,"galleryUI",2);H([o()],rt.prototype,"categoryName",2);H([o(ut)],rt.prototype,"icon",2);H([o(ne)],rt.prototype,"data",2);var an=Object.defineProperty,on=Object.getOwnPropertyDescriptor,ke=(s,t,i,r)=>{for(var e=r>1?void 0:r?on(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&an(t,i,e),e};class Ct extends h{constructor(){super(...arguments),this.title="",this.slug=""}initialize(t){this.galleryManager=t}start(){this.slug=ln(this.title),P("poi")===this.slug&&this.focus()}focus(){var t,i;Vt("poi",this.slug),(t=this.galleryManager)==null||t.poiFocused(this),this.cameraView&&(this.previousOrbitControls??(this.previousOrbitControls=ve(Nt)),(i=this.previousOrbitControls)==null||i.setCameraAndLookTarget(this.cameraView))}focusNext(){var t;(t=this.galleryManager)==null||t.focusNext()}focusPrevious(){var t;(t=this.galleryManager)==null||t.focusPrevious()}}ke([o(C)],Ct.prototype,"cameraView",2);ke([o()],Ct.prototype,"title",2);function ln(s){return s.trim().toLowerCase().replace(/ /g,"-")}var hn=Object.defineProperty,cn=Object.getOwnPropertyDescriptor,st=(s,t,i,r)=>{for(var e=r>1?void 0:r?cn(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&hn(t,i,e),e};class R extends h{constructor(){super(...arguments),this.pois=[],this.categoryName="",this.arrowKeysNavigation=!0,this.selectedPOIIndex=0}awake(){this.populateGalleryUI(this.pois),this.pois.forEach(t=>t.initialize(this))}populateGalleryUI(t){var r;if(!this.galleryUI)return;const i=(r=this.galleryUI)==null?void 0:r.categories.find(e=>e.title===this.categoryName);i&&t.forEach(e=>{const n=new W;n.name=e.title,n.icon=this.icon,n.click=new b,n.click.addEventListener(()=>{e.focus()}),i.items.push(n)})}poiFocused(t){const i=this.pois.indexOf(t);i!=-1&&(this.selectedPOIIndex=i)}focusNext(){var t;this.selectedPOIIndex=(this.selectedPOIIndex+1)%this.pois.length,(t=this.pois[this.selectedPOIIndex])==null||t.focus()}focusPrevious(){var t;this.selectedPOIIndex=(this.selectedPOIIndex-1+this.pois.length)%this.pois.length,(t=this.pois[this.selectedPOIIndex])==null||t.focus()}update(){if(this.arrowKeysNavigation){const t=this.context.input;t.isKeyDown("ArrowRight")?this.focusNext():t.isKeyDown("ArrowLeft")&&this.focusPrevious()}}}st([o(Ct)],R.prototype,"pois",2);st([o(it)],R.prototype,"galleryUI",2);st([o()],R.prototype,"categoryName",2);st([o(ut)],R.prototype,"icon",2);st([o()],R.prototype,"arrowKeysNavigation",2);var pn=Object.defineProperty,dn=Object.getOwnPropertyDescriptor,Be=(s,t,i,r)=>{for(var e=r>1?void 0:r?dn(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&pn(t,i,e),e};const Dt=P("debugmaterialx");class ae extends h{constructor(){super(...arguments),this.images=[]}async awake(){this.materialXAsset&&this.loadMaterialX(this.materialXAsset)}async loadMaterialX(t){const i=m.getComponent(this.gameObject,y);if(!i)return;const r=new Ii;r.resolveURL=a=>{if(a.startsWith("assets/"))return a;const p=a.split("/").pop();return Dt&&console.log("resolveURL",a,p),"assets/"+p};const n=await new Wi(r).setPath("").loadAsync(t).then(({materials:a})=>(Dt&&console.log("Loaded .mtlx materials",a),Object.values(a)[0]));Dt&&console.log("Loaded .mtlx material",n,t),n&&(i.sharedMaterial=n)}}Be([o(URL)],ae.prototype,"materialXAsset",2);Be([o(wi)],ae.prototype,"images",2);const mn=P("debugmaterialx");class un extends h{start(){const t=m.getComponent(this.gameObject,y);t&&(this.material=new Li({}),t.sharedMaterial=this.material,this.constructNodeGraph(this.material),this.material.needsUpdate=!0)}constructNodeGraph(t){const i=Fi(1),r=Ni.mul(10).add(i),e=zi(r);t.colorNode=e}update(){if(K()&&this.material&&this.constructNodeGraph!==this.methodCacheKey){mn&&console.log("rebuilding node graph"),this.methodCacheKey=this.constructNodeGraph;try{this.constructNodeGraph(this.material),this.material.needsUpdate=!0}catch(t){throw console.error(t),u(t.message,be.Error),t}}}}var fn=Object.defineProperty,gn=Object.getOwnPropertyDescriptor,bn=(s,t,i,r)=>{for(var e=r>1?void 0:r?gn(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&fn(t,i,e),e};class Ft extends h{constructor(){super(...arguments),this.time=0,this._timeThreshold=.3}awake(){this._director=this.gameObject.getComponentInChildren(_i)??void 0}onAfterRender(){if(!this._director)return;Math.abs(this._director.time-this.time)>this._timeThreshold&&(this.time=this._director.time)}onTimeChanged(){!this._director||Math.abs(this._director.time-this.time)<this._timeThreshold||(this._director.time=this.time,this._director.isPlaying||this._director.evaluate())}}bn([z(Ft.prototype.onTimeChanged)],Ft.prototype,"time",2);var xn=Object.defineProperty,vn=Object.getOwnPropertyDescriptor,q=(s,t,i,r)=>{for(var e=r>1?void 0:r?vn(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&xn(t,i,e),e};class L extends h{constructor(){super(...arguments),this.consumeClick=!0,this.consumeDown=!0,this.consumeMove=!0,this.consumeUp=!0,this.consumeHover=!0,this.stopPropagation=!0}onPointerDown(t){this.consumeDown&&t.use(),this.stopPropagation&&t.stopPropagation()}onPointerMove(t){this.consumeMove&&t.use(),this.stopPropagation&&t.stopPropagation()}onPointerUp(t){this.consumeUp&&t.use(),this.stopPropagation&&t.stopPropagation()}onPointerClick(t){this.consumeClick&&t.use(),this.stopPropagation&&t.stopPropagation()}onPointerEnter(t){this.consumeHover&&t.use(),this.stopPropagation&&t.stopPropagation()}onPointerExit(t){this.consumeHover&&t.use(),this.stopPropagation&&t.stopPropagation()}}q([o()],L.prototype,"consumeClick",2);q([o()],L.prototype,"consumeDown",2);q([o()],L.prototype,"consumeMove",2);q([o()],L.prototype,"consumeUp",2);q([o()],L.prototype,"consumeHover",2);q([o()],L.prototype,"stopPropagation",2);var wn=Object.defineProperty,_n=Object.getOwnPropertyDescriptor,On=(s,t,i,r)=>{for(var e=r>1?void 0:r?_n(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&wn(t,i,e),e};class Xe extends h{constructor(){super(...arguments),this.renderers=[]}select(t){this.renderers.forEach(i=>{i.probeAnchor=t})}}On([o(y)],Xe.prototype,"renderers",2);var yn=Object.defineProperty,Pn=Object.getOwnPropertyDescriptor,Cn=(s,t,i,r)=>{for(var e=r>1?void 0:r?Pn(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&yn(t,i,e),e};class oe extends h{constructor(){super(...arguments),this.displayName=""}}Cn([o()],oe.prototype,"displayName",2);var jn=Object.defineProperty,Sn=Object.getOwnPropertyDescriptor,jt=(s,t,i,r)=>{for(var e=r>1?void 0:r?Sn(t,i):t,n=s.length-1,a;n>=0;n--)(a=s[n])&&(e=(r?a(t,i,e):a(e))||e);return r&&e&&jn(t,i,e),e};class nt extends h{constructor(){super(...arguments),this.objects=[],this.hideContentOnStart=!0,this.index=-1}awake(){this.hideContentOnStart||(this.index=0);const t=P("variant");typeof t=="string"?this.index=parseInt(t):typeof t=="number"&&(this.index=t),this.apply()}next(){this.select(this.index+1)}previous(){this.select(this.index-1)}apply(){for(let t=0;t<this.objects.length;t++)this.objects[t].visible=t===this.index;if(this.lable){const t=this.objects[this.index];if(t){const i=m.getComponent(t,oe);this.lable.text=(i==null?void 0:i.displayName)??t.name}}}select(t){t<0&&(t=this.objects.length-1),this.index=t%this.objects.length,this.index=w.clamp(this.index,0,this.objects.length-1),Vt("variant",this.index.toString()),this.apply()}}jt([o(C)],nt.prototype,"objects",2);jt([o()],nt.prototype,"hideContentOnStart",2);jt([o(Q)],nt.prototype,"lable",2);jt([z(function(){this.apply()})],nt.prototype,"index",2);c.add("AspectRatioFitterUI",Rt);c.add("CameraGoal",ft);c.add("CameraLayer",Ki);c.add("Cannon",Y);c.add("RandomColor",Kt);c.add("ChangeColorOnCollision",Bi);c.add("IncreaseShaderSpeedOverTime",Ce);c.add("ClickButton",je);c.add("ClickToReset",Se);c.add("DepthOfFieldController",bt);c.add("DisableEnvironmentLight",hr);c.add("EmitParticlesOnClick",De);c.add("EnforceParameters",Te);c.add("HTMLButtonClick",Yt);c.add("HTMLMenu",Zt);c.add("IFrameContent",Z);c.add("ImageTrackingDownloadUI",yr);c.add("LODGroupUI",kt);c.add("Networking_ClickToChangeColor",$t);c.add("Networking_StringArray",At);c.add("Networking_Object",It);c.add("PerformanceSettings",Xt);c.add("Photographer",k);c.add("PhysicsCollision",B);c.add("PhysicsTrigger",X);c.add("PlayAnimationOnCollision",Ie);c.add("PlayAnimationOnTrigger",Le);c.add("PlayAudioOnCollision",Fe);c.add("ResetAnimationsForXR",Rr);c.add("ResponsiveContent",Jt);c.add("LoadingSceneRoot",ze);c.add("SceneLoadingEvents",ee);c.add("SceneSwitcherControls",Zr);c.add("SetBackfaceCulling",kr);c.add("ShowBalloonMessage",Ue);c.add("SimpleLeaderboard",Lt);c.add("StartPosition",Ve);c.add("AutoReset",We);c.add("SyncedRoomUI",Ge);c.add("TimedSpawn",He);c.add("TopMenu",Re);c.add("VideoBackground",gs);c.add("ResetPositionOnInterval",J);c.add("ToggleVisibility",vs);c.add("WireframeMaterial",qe);c.add("XRLifecycleEvents",ie);c.add("WebXRBodyTracking",Cs);c.add("Arrow",re);c.add("ArrowShooting",j);c.add("BowArrowTarget",Ye);c.add("BowTargetSpawner",Ze);c.add("CustomDepthSensing",Us);c.add("DeviceDetection",Vs);c.add("CustomUSDSettings",Ws);c.add("FadeOnProximity",U);c.add("PlayAnimationOnProximity",_t);c.add("SoundOnProximity",et);c.add("EverywhereConfigurator",Pt);c.add("ButtonAndTextFiller",rt);c.add("GalleryManager",R);c.add("GalleryPOI",Ct);c.add("GalleryUI",it);c.add("MaterialXAsset",ae);c.add("ShadeWithMaterialX",un);c.add("SyncedPlayableDirector",Ft);c.add("ConsumeAllPointers",L);c.add("ReflectionsSwitcher",Xe);c.add("VariantInfo",oe);c.add("VariantSwitcher",nt);
